#include "ch.h"
#include "hal.h"
#include "thermocouple.h"
#include "sysParam.h"

#define TCK_MIN_MV      -5.730
#define TCK_MAX_MV      15.975
#define TCK_SEG_N       20
#define TCK_SEG_P       40
#define TCK_TEMP_SEG    10

const float K_tctableN[] = {
  0,            -0.392, -0.778, -1.156, -1.527, -1.889, -2.243, -2.587, 2.920,  -3.243,
  -3.554,       -3.852, -4.138, -4.411, -4.669, -4.913, -5.141, -5.354, -5.550, -5.730
};

const float K_tctableP[] = {
  0,        0.397,  0.798,  1.203,  1.612,  2.023,  2.436,  2.851,  3.267,  3.682,
  4.096,    4.509,  4.920,  5.328,  5.735,  6.138,  6.540,  6.941,  7.340,  7.739,
  8.138,    8.539,  8.940,  9.343,  9.747,  10.153, 10.561, 10.971, 11.382, 11.795,
  12.209,   12.624, 13.040, 13.457, 13.874, 14.293, 14.713, 15.133, 15.554, 15.975,
  16.397,   16.820, 17.243, 17.667, 18.091, 18.516, 18.941, 19.366, 19.792, 20.218,
  20.664,   21.071, 21.497, 21.924, 22.350, 22.776, 23.203, 23.629, 24.055, 24.480,
  24.905,   25.330, 25.755, 26.179, 26.602, 27.025, 27.447, 27.869, 28.289, 28.710,
  29.129,   29.548, 29.965, 30.382, 30.798, 31.213, 31.628, 32.041, 32.453, 32.865,
  33.275,   33.685, 34.093, 34.501, 34.908, 35.313, 35.718, 36.121, 36.524, 36.925,
  37.326,   37.725, 38.124, 38.522, 38.918, 39.314, 39.708, 40.101, 40.494, 40.885,
  41.276,   41.665, 42.053, 42.440, 42.826, 43.211, 43.595, 43.978, 44.359, 44.740,
  45.119,   45.497, 45.873, 46.249, 46.623, 46.995, 47.367, 47.737, 48.105, 48.473,
  48.838,   49.202, 49.565, 49.926, 50.286, 50.644, 51.000, 51.355, 51.708, 52.060,
  52.410,   52.759, 53.106, 53.451, 53.795, 54.138, 54.479, 54.819
};

#define TCJ_MIN_MV  -7.890
#define TCJ_MAX_MV  21.848
const float J_tctableN[] = {
0,      -0501,  -0.995, -1.482, -1.961, -2.431, -2.893, -3.344, -3.786, -4.215,
-4.663, -5.037, -5.426, -5.801, -6.159, -6.500, -6.821, -7.123, -7.403, -7.659,-7.890
};

const float J_tctableP[] = {
0,      0.507,  1.091,  1.537,  2.059,  2.585,  3.116,  3.650,  4.187,  4.726,
5.269,  5.814,  6.360,  6.909,  7.459,  8.010,  8.562,  9.115,  9.669,  10.224,
10.779, 11.334, 11.889, 12.445, 13.000, 13.555, 14.110, 14.665, 15.219, 15.773,
16.327, 16.881, 17.434, 17.986, 18.538, 19.090, 19.642, 20.194, 20.745, 21.297,
21.848, 22.400, 22.952, 23.504, 24.057, 24.610, 25.164, 25.720, 26.276, 26.834,
27.393, 27.953, 28.516, 29.080, 29.647, 30.216, 30.788, 31.362, 31.939, 32.159,
33.102, 33.689, 34.279, 34.873, 35.470, 36.071, 36.675, 37.284, 37.896, 38.512,
39.132, 39.755, 40.382, 41.012, 41.645, 42.281, 42.919, 43.559, 44.203, 44.848,
45.494, 46.141, 46.786, 47.431, 48.047, 48.715, 49.353, 49.989, 50.662, 51.251,
51.877, 52.500, 53.119, 53.735, 54.347, 54.956, 55.561, 56.164, 56.763, 57.360,
57.953, 58.545, 59.134, 59.721, 60.307, 60.890, 61.473, 62.054, 62.634, 63.214,
63.792, 64.370, 64.948, 65.525, 66.102, 66.679, 67.255, 67.831, 68.406, 68.980,
};

const float E_tctableN[] = {
0.000,  -0.582, -1.152, -1.709, -2.255, -2.787, -3.306, -3.811, -4.302, -4.777,
-5.237, -5.681, -6.107, -6.561, -6.907, -7.279, -7.632, -7.963, -8.273, -8.561,
-8.825, -9.063, -9.274, -9.455, -9.604, -9.718, -9.797
};
const float E_tctableP[] = {
0.000,  0.591,  1.192,  1.801,  2.420,  3.048,  3.685,  4.330,  4.985,  5.648,
6.319,  6.998,  7.685,  8.379,  9.081,  9.789,  10.503, 11.224, 11.951, 12.684,
13.421, 14.164, 14.912, 15.664, 16.420, 17.181, 17.945, 18.713, 19.484, 20.259,
21.036, 21.817, 22.600, 23.386, 24.174, 24.964, 25.757, 26.552, 27.348, 28.146,
29.946, 29.747, 30.550, 31.354, 32.159, 32.965, 33.772, 34.579, 35.387, 36.196,
37.005, 37.815, 38.624, 39.434, 40.243, 41.053, 41.862, 42.671, 43.479, 44.286,
45.093, 45.900, 46.703, 47.509, 48.313, 49.116, 49.917, 50.718, 51.517, 52.315,
53.112, 53.908, 54.703, 55.497, 56.289, 57.080, 57.870, 58.659, 59.446, 60.232,
61.017, 61.801, 62.583, 63.364, 64.144, 64.922, 65.698, 66.473, 67.246, 68.017,
68.787, 69.554, 70.319, 71.082, 72.844, 72.603, 73.360, 74.115, 74.869, 75.621,
};

const float N_tctableN[] = {
0.000,  -0.260, -0.518, -0.772, -1.023, -1.269, -1.509, -1.744, -1.972, -2.193,
-2.407, -2.612, -2.88,  -2.994, -3.171, -3.336, -3.491, -3.634, -3.786, -3.884,
-3.990, -4.083, -4.162, -4.226, -4.277, -4.313, -4.336
};

const float N_tctableP[] = {
0.000,  0.261,  0.525,  0.793,  1.065,  1.340,  1.619,  1.902,  2.189,  2.480,
2.774,  3.072,  3.374,  3.680,  3.989,  4.302,  4.618,  4.937,  5.259,  5.585,
5.913,  6.245,  6.579,  6.916,  7.255,  7.597,  7.941,  8.288,  8.637,  8.988,
9.341,  9.696,  10.054, 10.413, 10.774, 11.136, 11.501, 11.867, 12.234, 12.603,
12.974, 13.346, 13.719, 14.094, 14.469, 14.848, 15.225, 15.604, 15.984, 16.366,
16.748, 17.131, 17.515, 17.900, 18.286, 18.672, 19.059, 19.447, 19.835, 20.224,
20.613, 21.003, 21.393, 21.784, 22.175, 22.556, 22.958, 23.350, 23.742, 24.134,
24.527, 24.919, 25.312, 25.705, 26.098, 26.491, 26.883, 27.276, 27.669, 28.062,
28.455, 28.847, 29.239, 29.632, 30.024, 30.416, 30.807, 31.199, 31.519, 31.981,
32.371, 32.761, 33.151, 33.541, 33.930, 34.319, 34.707, 35.095, 35.482, 35.869,
36.256, 36.841, 37.027, 37.411, 37.795, 37.179, 38.562, 38.944, 39.326, 39.708,
40.087, 40.466, 40.845, 41.223, 41.600, 41.976, 42.352, 42.727, 43.101, 43.474,
43.846, 44.218, 44.588, 44.958, 45.326, 45.694, 46.060, 46.425, 46.789, 47.152
};

const float R_tctableN[] = {
0.000,  -0.051, -0.100, -0.145, -0.188
};
const float R_tctableP[] = {
0.000,  0.054,  0.111,  0.171,  0.232,  0.296,  0.363,  0.431,  0.501,  0.573,
0.647,  0.723,  0.800,  0.879,  0.959,  1.041,  1.124,  1.208,  1.294,  1.381,
1.469,  1.558,   1.648,  1.739,  1.831,  1.923,  2.017,  2.112,  2.207,  2.304,
2.401,  2.498,  2.597,  2.696,  2.796,  2.896,  2.997,  3.099,  3.201,  3.304,
3.408,  3.512,  3.616,  3.721,  3.827,  3.933,  4.040,  4.147,  4.255,  4.363,
4.471,  4.580,  4.690,  4.800,  4.910,  5.021,  5.133,  5.245,  5.357,  5.470,
5.583,  5.697,  5.812,  5.926,  6.041,  6.157,  6.273,  6.390,  6.507,  6.625,
6.743,  6.861,  6.980,  7.100,  7.220,  7.340,  7.461,  7.583,  7.705,  7.827,
7.950,  8.073,  8.197,  8.321,  8.446,  8.571,  8.697,  8.823,  8.950,  9.077,
9.205,  9.333,  9.461,  9.590,  9.720,  9.850,  9.980,  10.111, 10.242, 10.374,
10.506, 10.638, 10.771, 10.905, 11.039, 11.173, 11.307, 11.442, 11.578, 11.714,
11.850, 11.986, 12.123, 12.260, 12.397, 12.535, 12.673, 12.812, 12.950, 13.089,
13.228, 13.367, 13.507, 13.646, 13.786, 13.926, 14.066, 14.207, 14.347, 14.488,
14.629, 14.770, 14.911, 15.052, 15.193, 15.334, 15.475, 15.616, 15.758, 15.899,
16.040, 16.181, 16.323, 16.464, 16.605, 16.746, 16.887, 17.028, 17.169, 17.310,
17.451, 17.591, 17.732, 17.872, 18.012, 18.152, 18.292, 18.431, 18.571, 18.710,
18.849, 18.988, 19.126, 19.264, 19.402, 19.540, 19.677, 19.814, 19.951, 20.087,
20.222, 20.356, 20.488, 20.620, 20.749, 20.877, 21.003
};

const float S_tctableN[] = {
0.000,  -0.053, -0.103, -0.150, -0.194
};
const float S_tctableP[] = {
0.000,  0.055,  0.113,  0.173,  0.235,  0.299,  0.365,  0.433,  0.502,  0.573,
0.646,  0.720,  0.795,  0.872,  0.950,  1.029,  1.110,  1.191,  1.273,  1.357,
1.441,  1.526,  1.612,  1.698,  1.786,  1.874,  1.962,  2.052,  2.141,  2.232,
2.323,  2.415,  2.507,  2.599,  2.692,  2.786,  2.880,  2.974,  3.069,  3.164,
3.259,  3.355,  3.415,  3.548,  3.645,  3.742,  3.840,  3.938,  4.036,  4.134,
4.233,  4.332,  4.432,  4.532,  4.632,  4.732,  4.833,  4.934,  5.035,  5.137,
5.239,  5.341,  5.443,  5.546,  5.649,  5.753,  5.857,  5.931,  6.065,  6.170,
6.275,  6.318,  6.486,  6.593,  6.699,  6.806,  6.913,  7.020,  7.128,  7.236,
7.345,  7.454,  7.563,  7.673,  7.783,  7.893,  8.003,  8.114,  8.226,  8.337,
8.449,  8.562,  8.674,  8.787,  8.900,  9.014,  9.128,  9.242,  9.357,  9.472,
9.587,  9.703,  9.819,  9.935,  10.051, 10.168, 10.285, 10.403, 10.520, 10.638,
10.757, 10.875, 10.994, 11.113, 11.232, 11.351, 11.471, 11.590, 11.710, 11.830,
11.951, 12.071, 12.191, 12.312, 12.433, 12.554, 12.675, 12.796, 12.917, 13.038,
13.159, 13.280, 13.402, 13.523, 13.644, 13.766, 13.887, 14.009, 14.130, 140251,
14.373, 14.494, 14.615, 14.736, 14.857, 14.978, 15.099, 15.220, 15.341, 15.461,
15.582, 15.702, 15.822, 15.942, 16.062, 16.182, 16.301, 16.420, 16.539, 16.658,
16.777, 16.895, 17.013, 17.131, 17.249, 17.366, 17.483, 17.600, 17.717, 17.832,
17.947, 18.061, 18.174, 18.285, 18.395, 18.503, 18.609
};

const float T_tctableN[] = {
0.000,  -0.383, -0.757, -1.121, -1.475, -1.819, -2.153, -2.476, -2.788, -3.089,
-3.379, -3.657, -3.923, -4.177, -4.419, -4.648, -4.865, -5.070, -5.261, -5.439,
-5.603, -5.753, -5.888, -6.007, -6.105, -6.180, -6.232
};
const float T_tctableP[] = {
0.000,  0.391,  0.790,  1.196,  1.612,  2.036,  2.468,  2.909,  3.358,  3.814,
4.279,  4.750,  5.228,  5.714,  6.206,  6.740,  7.209,  7.720,  8.237,  8.759,
9.288,  9.822,  10.362, 10.907, 11.458, 12.013, 12.574, 13.139, 13.709, 14.283,
14.862, 15.445, 16.032, 16.624, 17.219, 17.819, 18.422, 19.030, 19.641, 20.255
};
const float PT100_tableN[] = {
  100,  96.09,  92.16,  88.22,  84.27,  80.31,  76.33,  72.33,  68.33,  64.30,  60.26,
  56.19,    52.11,  48.00,  43.88,  39.72,  35.54,  31.34,  27.10,  22.83,  18.52
};

const float PT100_tableP[] = {
  100,  103.9,  107.79, 111.67, 115.54, 119.40, 123.24, 127.08, 130.90, 134.71,
  138.51,  142.29,   146.07, 149.83, 153.58, 157.33, 161.05, 164.77, 168.48, 172.17,
  175.86,   179.53, 183.19, 186.84, 190.47, 194.10, 197.71, 201.31, 204.90, 208.48,
  212.05,   215.61, 219.15
};

//const float PT1000_tableN[] = {
//  1000.0, 996.09, 992.18, 988.27, 984.36, 980.44, 976.53, 972.61, 968.7,  964.78, 960.86,
//  956.94, 953.02,   949.09, 947.17, 941.24, 937.32, 933.39, 929.46, 925.53, 921.6,
//  917.67,   913.73, 909.8,  905.86, 901.92, 897.99, 894.04, 890.1,  886.16, 882.22,
//  878.27,   874.33, 870.38, 866.43, 862.48, 858.53, 854.57, 850.62, 846.66, 842.71,
//  838.75,   834.79, 830.83, 826.87, 822.9,  818.94, 814.97, 811.00, 807.03, 803.06,
//  799.09,   795.12, 791.14, 787.17, 783.19, 779.21, 775.23, 771.25, 767.26, 763.28,
//  759.29,   755.3,  751.32, 747.32, 743.33, 739.34, 734.34, 731.34, 727.35, 723.35,
//  719.34,   715.34, 711.34, 707.33, 703.32, 699.31, 695.3,  691.29, 687.27, 683.25
//};
const float PT1000_tableN[] = {
  1000.0, 960.86, 921.6,  882.22, 842.71, 803.06, 763.28, 723.35, 683.25
};

const float PT1000_tableP[] = {
  1000.0,   1039,   1077.9, 1116.7, 1155.4, 1194,   1232.4, 1270.8, 1309,   1347.1,
  1385.1,   1422.9, 1460.7, 1498.3, 1535.8, 1573.3, 1610.5, 1647.7, 1684.8, 1721.7,
  1758.6,   1795.3, 1831.9, 1868.4, 1904.7, 1941,   1977.1, 2013.1, 2049,   2084.8,
  2120.5
};


static uint8_t sensorType;
static double coldT,humidity;
static double sensorT;
static uint8_t useCompensation = 1;

const float *tableN, *tableP;
float minMv,maxMv;
float deltaT;
int segP, segN;

void tempUseComp(uint8_t state)
{
  useCompensation = state;
}

double tckFromMvToT(double mv, double *t)
{
  double retv = 0.0;
  uint8_t i;
  if(mv == 0.0){
    *t = 0.;
  }else if(mv > 0.0){
    if(mv > TCK_MAX_MV) *t = 0.0;
    else{
      for(i=0;i<TCK_SEG_P;i++){
        if(mv < K_tctableP[i]){
          i--;
          break;
        }
      }
      *t = (mv - K_tctableP[i])*TCK_TEMP_SEG/(K_tctableP[i+1] - K_tctableP[i]) + i*TCK_TEMP_SEG;
    }
  }else{
    if(mv < TCK_MIN_MV) *t = 0.0;
    else{
      for(i=0;i<TCK_SEG_N;i++){
        if(mv > K_tctableN[i]){
          i--;
          break;
        }
      }
      *t = (mv - K_tctableP[i])*TCK_TEMP_SEG/(K_tctableP[i+1] - K_tctableP[i]) + i*TCK_TEMP_SEG;
    }
  }
  
  retv = *t;
  return retv;
}

double tcFromMvToT(double mv)
{
  double retv = 0.0;
  uint16_t i;
  if(mv == 0.0){
    retv = 0.;
  }else if(mv > 0.0){
    if(mv > maxMv)
      retv = 0.0;
    else{
      for(i=0;i<segP;i++){
        if(mv < tableP[i]){
          i--;
          break;
        }
      }
      retv = (mv - tableP[i])*deltaT/(tableP[i+1] - tableP[i]) + i*deltaT;
    }
  }else{
    if(mv < minMv)
      retv = 0.0;
    else{
      for(i=0;i<segN;i++){
        if(mv > tableN[i]){
          i--;
          break;
        }
      }
      retv = -(i*deltaT + (mv - tableN[i])*deltaT/(tableN[i+1] - tableN[i]));
      //retv *= -1;
    }
  }

  return retv;
}
double ptFromRToT(double r)
{
  double retv = 0.0;
  uint16_t i;
  if(r == 100.0){
    retv = 0.;
  }else if(r >= 100.0){
    if(r > maxMv)
      retv = 0.0;
    else{
      for(i=0;i<segP;i++){
        if(r < tableP[i]){
          i--;
          break;
        }
      }
      retv = (r - tableP[i])*deltaT/(tableP[i+1] - tableP[i]) + i*deltaT;
    }
  }else{
    if(r < minMv)
      retv = 0.0;
    else{
      for(i=0;i<segN;i++){
        if(r > tableN[i]){
          i--;
          break;
        }
      }
      retv = (r - tableN[i])*deltaT/(tableN[i+1] - tableN[i]) + i*deltaT;
      retv = -retv;
    }
  }

  return retv;
}

//void updateSensorVolt(double volt)
double getTempFromV(uint8_t type, double v)
{
  double t = 0;
  deltaT = 10;
  switch(type){
  case AIO_TCK:
    tableP = &K_tctableP[0];
    tableN = K_tctableN;
    segP = sizeof(K_tctableP)/sizeof(float) - 1;
    segN = sizeof(K_tctableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP);
    minMv = *(tableN + segN);
    if(useCompensation)
      t = tcFromMvToT(v*1000) + coldT;
    else
      t = tcFromMvToT(v*1000);
    break;
  case AIO_TCT:
    tableP = T_tctableP;
    tableN = T_tctableN;
    segP = sizeof(T_tctableP)/sizeof(float) - 1;
    segN = sizeof(T_tctableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP);
    minMv = *(tableN + segN);
    if(useCompensation)
      t = tcFromMvToT(v*1000) + coldT;
    else
      t = tcFromMvToT(v*1000);
    break;
  case AIO_TCJ:
    tableP = J_tctableP;
    tableN = J_tctableN;
    segP = sizeof(J_tctableP)/sizeof(float) - 1;
    segN = sizeof(J_tctableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP);
    minMv = *(tableN + segN);
    if(useCompensation)
      t = tcFromMvToT(v*1000) + coldT;
    else
      t = tcFromMvToT(v*1000);
    break;
  case AIO_TCE:
    tableP = E_tctableP;
    tableN = E_tctableN;
    segP = sizeof(E_tctableP)/sizeof(float) - 1;
    segN = sizeof(E_tctableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP );
    minMv = *(tableN + segN );
    if(useCompensation)
      t = tcFromMvToT(v*1000) + coldT;
    else
      t = tcFromMvToT(v*1000);
    break;
  case AIO_TCN:
    tableP = N_tctableP;
    tableN = N_tctableN;
    segP = sizeof(N_tctableP)/sizeof(float) - 1;
    segN = sizeof(N_tctableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP );
    minMv = *(tableN + segN );
    if(useCompensation)
      t = tcFromMvToT(v*1000) + coldT;
    else
      t = tcFromMvToT(v*1000);
    break;
  case AIO_TCR:
    tableP = R_tctableP;
    tableN = R_tctableN;
    segP = sizeof(R_tctableP)/sizeof(float) - 1;
    segN = sizeof(R_tctableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP );
    minMv = *(tableN + segN );
    if(useCompensation)
      t = tcFromMvToT(v*1000) + coldT;
    else
      t = tcFromMvToT(v*1000);
    break;
  case AIO_TCS:
    tableP = S_tctableP;
    tableN = S_tctableN;
    segP = sizeof(S_tctableP)/sizeof(float) - 1;
    segN = sizeof(S_tctableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP );
    minMv = *(tableN + segN );
    if(useCompensation)
      t = tcFromMvToT(v*1000) + coldT;
    else
      t = tcFromMvToT(v*1000);
    break;
  case AIO_TCU:
//    tableP = U_tctableP;
//    tableN = U_tctableN;
//    segP = sizeof(U_tctableP)/sizeof(float) - 1;
//    segN = sizeof(U_tctableN)/sizeof(float) - 1;
//    maxMv = *(tableP + segP );
//    minMv = *(tableN + segN );
//    t = tcFromMvToT(v*1000) + coldT;
    break;
  case AIO_TCB:
//    tableP = B_tctableP;
//    tableN = B_tctableN;
//    segP = sizeof(B_tctableP)/sizeof(float) - 1;
//    segN = sizeof(B_tctableN)/sizeof(float) - 1;
//    maxMv = *(tableP + segP );
//    minMv = *(tableN + segN );
//    t = tcFromMvToT(v*1000) + coldT;
    break;
  case AIO_TCG:
//    tableP = G_tctableP;
//    tableN = G_tctableN;
//    segP = sizeof(G_tctableP)/sizeof(float) - 1;
//    segN = sizeof(G_tctableN)/sizeof(float) - 1;
//    maxMv = *(tableP + segP );
//    minMv = *(tableN + segN );
//    t = tcFromMvToT(v*1000) + coldT;
    break;
  case AIO_TCC:
//    tableP = C_tctableP;
//    tableN = C_tctableN;
//    segP = sizeof(C_tctableP)/sizeof(float) - 1;
//    segN = sizeof(C_tctableN)/sizeof(float) - 1;
//    maxMv = *(tableP + segP );
//    minMv = *(tableN + segN );
//    t = tcFromMvToT(v*1000) + coldT;
    break;
  case AIO_TCD:
//    tableP = D_tctableP;
//    tableN = D_tctableN;
//    segP = sizeof(D_tctableP)/sizeof(float) - 1;
//    segN = sizeof(D_tctableN)/sizeof(float) - 1;
//    maxMv = *(tableP + segP );
//    minMv = *(tableN + segN );
//    t = tcFromMvToT(v*1000) + coldT;
    break;
  case AIO_PT100:
    tableP = PT100_tableP;
    tableN = PT100_tableN;
    segP = sizeof(PT100_tableP)/sizeof(float) - 1;
    segN = sizeof(PT100_tableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP);   // actually is R
    minMv = *(tableN + segN);
    t = ptFromRToT(v);
    break;
  case AIO_PT1000:
    tableP = PT1000_tableP;
    tableN = PT1000_tableN;
    segP = sizeof(PT1000_tableP)/sizeof(float) - 1;
    segN = sizeof(PT1000_tableN)/sizeof(float) - 1;
    maxMv = *(tableP + segP);   // actually is R
    minMv = *(tableN + segN);
    t = tcFromMvToT(v);
    break;
  }
  return t;
}

void updateColdT(double t)
{
  coldT = t;
}

void updateHumidity(double t)
{
  humidity = t;
}

double getBoardTemp(void)
{
  return coldT;
}

double getBoardHumidity(void)
{
  return humidity;
}

void thermocoupleInit()
{
  
}
